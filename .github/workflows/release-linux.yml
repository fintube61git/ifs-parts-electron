name: Release Linux (deb only)
on:
push:
tags:
- "v*"
permissions:
contents: write
jobs:
linux:
runs-on: ubuntu-22.04
steps:
- uses: actions/checkout@v4
with: { fetch-depth: 0 }
- uses: actions/setup-node@v4
with:
node-version: "20"
cache: "npm"
- name: Print package version (sanity)
run: node -p "require('./package.json').version"
- name: Install system deps
run: |
sudo apt-get update
sudo apt-get install -y build-essential fakeroot dpkg-dev libarchive-tools
- name: Install project deps (clean)
run: npm ci
- name: Remove old build outputs
run: rm -rf out dist_upload || true
- name: Ensure deb maker
run: npm i -D @electron-forge/maker-deb
- name: Make .deb (verbose)
run: npx electron-forge make --targets=@electron-forge/maker-deb --platform=linux --arch=x64 --verbose
- name: Show outputs and versioned filename
run: |
ls -la out/make/deb/x64 || true
echo "Built version: $(node -p "require('./package.json').version")"
- name: Collect .deb for upload
run: |
mkdir -p dist_upload
find out/make/deb -type f -name ".deb" -exec cp -v {} dist_upload/ ;
ls -la dist_upload
- name: Create GitHub Release
uses: softprops/action-gh-release@v2
with:
draft: false
prerelease: false
files: dist_upload/
generate_release_notes: true